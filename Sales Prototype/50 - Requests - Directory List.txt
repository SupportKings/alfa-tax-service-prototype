<!-- =========================
     REQUESTS - DIRECTORY LIST VIEW
     ========================= -->

<!-- Page Summary for Requests
List Fields:
– request_number
– company_id (lookup to companies.full_name)
– title
– request_type_category_id
– source_category_id
– priority_category_id
– status_category_id

KPIs (prototype):
– Open Tasks: Requests not yet Resolved or Won't Do
– Status: Distribution across request statuses
– Trends: Requests received per week (spikes during tax season)
-->

<!-- Process Remarks
The central triage hub replacing Kathy's brain. All requests from TaxDome, email, phone, WhatsApp, website, and walk-ins land here. Filter by source to see channel volume, by priority to find urgent items, by status to manage the queue.
-->

<page name="requestsList" layout="DirectoryList" displayName="Requests">

  <kpis>
    <kpi id="requests_open_tasks_1"
         name="Open Requests"
         type="Incomplete Task Count"
         displayType="Single Value"
         axesSummary="none"
         version="PROTOTYPE" />
  </kpis>

  <kpis>
    <kpi id="requests_status_1"
         name="Request Status Breakdown"
         type="Status Value"
         displayType="Single Value"
         axesSummary="none"
         version="PROTOTYPE" />
  </kpis>

  <kpis>
    <kpi id="requests_trend_1"
         name="Requests Received Over Time"
         type="Trend"
         displayType="Line Chart"
         axesSummary="Week vs New Request Count"
         version="PROTOTYPE" />
  </kpis>

  <component
    name="requestsList"
    layout="ListView"
    table_id="requests"
    createButton="VISIBLE"
    editType="DETAILS"
  >
    <field id="request_number" displayName="Request #" displayType="Text" tooltip="Unique request reference" />
    <field id="company_id" displayName="Client" enableInlineEdit="FALSE" tooltip="Which client this request is from">
      <lookup>
        <ref table_id="companies" field_id="full_name" />
      </lookup>
    </field>
    <field id="title" displayName="Title" displayType="Text" tooltip="Brief description of the request" />
    <field id="request_type_category_id" displayName="Type" displayType="SingleSelect" tooltip="Support, Question, Escalation, or Internal Discovery" />
    <field id="source_category_id" displayName="Source" displayType="SingleSelect" tooltip="Where this request came from — TaxDome, Email, Phone, WhatsApp, Website, Walk-In" />
    <field id="priority_category_id" displayName="Priority" displayType="SingleSelect" tooltip="Low, Normal, or Urgent" />
    <field id="status_category_id" displayName="Status" displayType="SingleSelect" tooltip="Current request status" />

    <rowSnapshots>
      <snapshot id="requests_row_snapshot_1"
                name="Request Age & Assignment"
                type="Row Snapshot"
                displayType="Row Snapshot"
                show_delta="TRUE"
                delta_window="WoW"
                version="PROTOTYPE" />
    </rowSnapshots>

    <!-- Optional list fields -->
    <!-- <field id="related_entity_type" displayName="Related To" displayType="Text" tooltip="Tax return, advisory engagement, etc." /> -->
  </component>
</page>